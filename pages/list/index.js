import Head from "next/head";
import VideoCard from "@/components/VideoCard";

export const getServerSideProps = async (context) => {
  const { list, title, description } = context.query;
  let urlData = [];

  if (list && typeof list === "string") {
    urlData.push({
      id: list,
      title: title || "",
      description: description || "",
    });
  } else if (list && Array.isArray(list)) {
    urlData = list.map((id, index) => ({
      id,
      title: Array.isArray(title) ? title[index] || "" : "",
      description: Array.isArray(description) ? description[index] || "" : "",
    }));
  }

  return { props: { urlData } };
};

export default function List({ urlData }) {
  return (
    <>
      <Head>
        <title>YT Playlist Creator & Sharer</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
      </Head>
      <main className="mt-4 mb-[50px] flex flex-col">
        <h1 className="text-center text-[30px]">My Playlist</h1>
        <div className="mt-[20px] px-[120px] flex flex-col gap-[20px]">
          {urlData.length > 0 ? (
            urlData.map((url, index) => <VideoCard key={index} url={url} />)
          ) : (
            <p className="text-center text-gray-500 text-lg">No available playlist</p>
          )}
        </div>
      </main>
    </>
  );
}
